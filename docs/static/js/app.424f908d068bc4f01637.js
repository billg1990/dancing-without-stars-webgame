webpackJsonp([1],{"87im":function(t,e){},Hydb:function(t,e){},NHnr:function(t,e,i){"use strict";function s(t){i("xfsC")}function r(t){i("Hydb")}function a(t){i("87im")}Object.defineProperty(e,"__esModule",{value:!0});var n=i("7+uW"),o=i("zL8q"),h=i.n(o),l=(i("tvR6"),{name:"app"}),c=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{attrs:{id:"app"}},[i("router-view")],1)},u=[],d={render:c,staticRenderFns:u},p=d,m=i("VU/8"),f=s,v=m(l,p,!1,f,null,null),g=v.exports,T=i("/ocq"),y={name:"Tile",props:["tileLength","content","index","tileClicked","tileType"],methods:{getContentColor:function(t){var e=["#483D8B","#8B0000","#4B0082","#0000CD","#808000","#8B4513"];if("#"===t||""===t)return"black";var i=parseInt(t);return i<=8?e[i-1]:"black"},getBtnType:function(){return 0===this.tileType?"primary":1===this.tileType?"success":2===this.tileType?"info":"warning"},handleClick:function(t){this.tileClicked(this.index)}}},b=function(){var t=this,e=t.$createElement;return(t._self._c||e)("el-button",{staticClass:"Tile",style:{width:this.tileLength+"px",height:this.tileLength+"px",fontSize:.6*this.tileLength+"px",color:t.getContentColor(this.content),marginLeft:"0px"},attrs:{type:t.getBtnType(),value:t.index},on:{click:t.handleClick}},[t._v(t._s(this.content))])},k=[],x={render:b,staticRenderFns:k},S=x,w=i("VU/8"),_=r,B=w(y,S,!1,_,null,null),C=B.exports,F={name:"Board",props:["boardLength","tiles","tileTypes","tileClicked"],components:{Tile:C}},M=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("el-button-group",{staticClass:"Board",style:{width:this.boardLength+1*Math.sqrt(this.tiles.length)+2+"px",height:this.boardLength+2*Math.sqrt(this.tiles.length)+1+"px"}},t._l(t.tiles,function(e,s){return i("Tile",{key:s,attrs:{tile:e,index:s,tileLength:t.boardLength/Math.sqrt(t.tiles.length),content:e,tileClicked:t.tileClicked,tileType:t.tileTypes[s]}})}))},P=[],D={render:M,staticRenderFns:P},L=D,I=i("VU/8"),A=a,O=I(F,L,!1,A,null,null),G=O.exports,E=i("lHA8"),z=i.n(E),R=i("c/Tr"),N=i.n(R),V=i("ifoU"),H=i.n(V),W=i("Zrlr"),$=i.n(W),j=i("wxAW"),U=i.n(j),q=function t(e,i){$()(this,t),this.row=e,this.col=i},J=q,Y=function(){function t(e,i,s){$()(this,t),this.n=e,this.c=i,this.k=s,this.board=[],this.tileTypes=[];for(var r=0;r<e*e;r++)this.board.push(""),this.tileTypes.push(0);this.dancerGenerated=!1,this.stars=[],this.step=0,this.picked=-1,this.numMoved=0,this.moved=new H.a}return U()(t,[{key:"getRandomIntInclusive",value:function(t,e){return t=Math.ceil(t),e=Math.floor(e),Math.floor(Math.random()*(e-t+1))+t}},{key:"posToIndex",value:function(t){return t.row*this.n+t.col}},{key:"indexToPos",value:function(t){var e=Math.floor(t/this.n),i=Math.floor(t%this.n);return new J(e,i)}},{key:"manhattanDistance",value:function(t,e){return Math.abs(t.row-e.row)+Math.abs(t.col-e.col)}},{key:"okToPlaceAStar",value:function(t){if(this.stars.length>=this.k)return!1;var e=this.posToIndex(t);if(!this.insideBoard(t))return!1;if(""!==this.board[e])return!1;for(var i=!0,s=0;s<this.stars.length;s++)if(this.manhattanDistance(this.stars[s],t)<this.c+1){i=!1;break}return i}},{key:"insideBoard",value:function(t){return t.row>=0&&t.col>=0&&this.n>t.row&&this.n>t.col}},{key:"checkChoreographerFinish",value:function(){var t=new H.a;for(var e in this.board)if(""!==this.board[e]&&"#"!==this.board[e]){var i=this.explore(this.indexToPos(e),new H.a);for(var s in i){var r=i[s];if(r){r=N()(r),r=r.sort();var a=r.join();t.set(a,r)}}}var n=[];return t.forEach(function(t,e,i){n.push(t)}),this.checkResultLines(n,N()(this.board))}},{key:"checkResultLines",value:function(t,e){if(!e||!t)return!1;if(0===t.length){var i=!0;for(var s in e)if(""!==e[s]&&"#"!==e[s]){i=!1;break}return i}var r=t.pop(),a=this.checkResultLines(t,this.removeLineFromBoard(r,e));return!!a||!!(a=this.checkResultLines(t,e))}},{key:"removeLineFromBoard",value:function(t,e){var i=N()(e);for(var s in t){if(""===i[t[s]]||"#"===i[t[s]]){i=null;break}i[t[s]]=""}return i}},{key:"explore",value:function(t,e){var i=this;if(""===this.board[this.posToIndex(t)]||"#"===this.board[this.posToIndex(t)])return[];var s=this.board[this.posToIndex(t)];if(e.get(s))return[];var r=new H.a(e);if(r.set(s,this.posToIndex(t)),r.size===this.c){var a=new z.a;return r.forEach(function(t,e,i){a.add(t)}),[a]}var n=[],o=new J(t.row-1,t.col);if(this.insideBoard(o)){var h=!1;if(e.forEach(function(t,e,s){t===i.posToIndex(o)&&(h=!0)}),!h){var l=this.explore(o,r);n.push.apply(n,l)}}var c=new J(t.row+1,t.col);if(this.insideBoard(c)){var u=!1;if(e.forEach(function(t,e,s){t===i.posToIndex(c)&&(u=!0)}),!u){var d=this.explore(c,r);n.push.apply(n,d)}}var p=new J(t.row,t.col-1);if(this.insideBoard(p)){var m=!1;if(e.forEach(function(t,e,s){t===i.posToIndex(p)&&(m=!0)}),!m){var f=this.explore(p,r);n.push.apply(n,f)}}var v=new J(t.row,t.col+1);if(this.insideBoard(v)){var g=!1;if(e.forEach(function(t,e,s){t===i.posToIndex(v)&&(g=!0)}),!g){var T=this.explore(v,r);n.push.apply(n,T)}}return n}},{key:"generateDancers",value:function(){if(!this.dancerGenerated){for(var t=0;t<this.c;t++)for(var e=0;e<this.k;){var i=this.getRandomIntInclusive(0,this.n*this.n-1);""===this.board[i]&&(this.board[i]=(t+1).toString(),this.tileTypes[i]=2,e++)}this.dancerGenerated=!0}}},{key:"placeAStar",value:function(t){var e=this.posToIndex(t);this.board[e]="#",this.stars.push(t)}},{key:"cancelAStar",value:function(t){var e=this.posToIndex(t);if("#"===this.board[e]){this.board[e]="";var i=-1;for(var s in this.stars)if(t.row===this.stars[s].row&&t.col===this.stars[s].col){i=s;break}i>-1&&this.stars.splice(i,1)}}},{key:"toggleStar",value:function(t){var e=this.indexToPos(t);if("#"===this.board[t]){this.cancelAStar(e);for(var i in this.tileTypes)"#"===this.board[i]?this.tileTypes[i]=1:this.okToPlaceAStar(this.indexToPos(i))?this.tileTypes[i]=0:this.tileTypes[i]=2;return-1}if(this.okToPlaceAStar(e)){this.placeAStar(e);for(var s in this.tileTypes)"#"===this.board[s]?this.tileTypes[s]=1:this.okToPlaceAStar(this.indexToPos(s))?this.tileTypes[s]=0:this.tileTypes[s]=2;return 1}return 0}},{key:"donePose",value:function(){for(var t in this.tileTypes)this.tileTypes[t]=0}},{key:"startSolve",value:function(){for(var t in this.tileTypes)"#"===this.board[t]&&(this.tileTypes[t]=2)}},{key:"toggleDancer",value:function(t){if(-1===this.picked)""===this.board[t]||"#"===this.board[t]||(this.moved.get(t)?(this.cancelDancerMove(t),this.updateDancerTileTypes()):(this.picked=t,this.updateDancerTileTypes()));else if("#"===this.board[t]||this.moved.get(t));else if(this.insideBoard(this.indexToPos(t)))if(this.manhattanDistance(this.indexToPos(this.picked),this.indexToPos(t))>1);else{""===this.board[t]?(this.numMoved+=1,this.moved.set(t,this.picked)):this.picked===t?(this.numMoved+=1,this.moved.set(t,this.picked)):(this.numMoved+=2,this.moved.set(t,this.picked),this.moved.set(this.picked,t));var e=this.board[t];if(this.board[t]=this.board[this.picked],this.board[this.picked]=e,this.picked=-1,this.updateDancerTileTypes(),this.numMoved===this.c*this.k)return this.nextStep()}else;return!1}},{key:"cancelDancerMove",value:function(t){var e=t,i=this.moved.get(e);if(""===this.board[i]){this.numMoved-=1,this.moved.delete(e);var s=this.board[e];this.board[e]=this.board[i],this.board[i]=s}else if(this.moved.get(i)===e){this.numMoved-=2,this.moved.delete(e),this.moved.delete(i);var r=this.board[e];this.board[e]=this.board[i],this.board[i]=r}else{this.cancelDancerMove(i),this.numMoved-=1,this.moved.delete(e);var a=this.board[e];this.board[e]=this.board[i],this.board[i]=a}}},{key:"updateDancerTileTypes",value:function(){for(var t=0;t<this.board.length;t++)-1===this.picked?this.moved.has(t)?this.tileTypes[t]=3:"#"===this.board[t]?this.tileTypes[t]=2:this.tileTypes[t]=0:this.moved.has(t)?this.tileTypes[t]=2:"#"===this.board[t]?this.tileTypes[t]=2:this.picked===t?this.tileTypes[t]=1:1===this.manhattanDistance(this.indexToPos(this.picked),this.indexToPos(t))?this.tileTypes[t]=0:this.tileTypes[t]=2}},{key:"gotoNextStep",value:function(){this.step+=1,this.numMoved=0,this.moved.clear(),this.updateDancerTileTypes()}},{key:"nextStep",value:function(){return this.gotoNextStep(),this.checkChoreographerFinish()}},{key:"getBoard",value:function(){return this.board}},{key:"getTileTypes",value:function(){return this.tileTypes}},{key:"getNumStep",value:function(){return this.step}}]),t}(),Z=Y,K={name:"Game",components:{Board:G},data:function(){return{aboutDialogVisible:!1,gamePanelVisible:!1,gameStatus:"Initialized",mainBtnText:"GO!",disableMainBtn:!1,gameLevel:0,game:null,step:0,numOfStars:0,maxNumOfStars:0,time:120,timer:null,timerOn:!1,startTime:null,tiles:[],tileTypes:[]}},methods:{openGamePanel:function(){var t=this.getGameParams();this.game=new Z(t.size,t.groups,t.dancers),this.maxNumOfStars=this.game.k,this.refreshBoard(),this.gamePanelVisible=!0},refreshBoard:function(){this.tileTypes=this.game.getTileTypes();var t=[];for(var e in this.game.getBoard())t.push(this.game.getBoard()[e]);this.tiles=t},handleMainBtn:function(){if("Initialized"===this.gameStatus)this.startPose();else if("Spoiler"===this.gameStatus)0===this.numOfStars?this.$message({message:"You haven't placed any star.",type:"warning"}):(this.stopTimer(),this.donePose());else if("SpoilerFinish"===this.gameStatus)this.resetTimer(),this.startChoreographer();else if("Finish"===this.gameStatus)this.resetGame();else if("Choreographer"===this.gameStatus){var t=this.game.nextStep();this.step+=1,this.refreshBoard(),t&&this.choreoFinish()}},handleCancel:function(t){this.resetGame(),t()},levelFormatTooltip:function(t){return 0===t?"easy":1===t?"intermediate":2===t?"hard":"hell"},vhTOpx:function(t){var e=window,i=document,s=i.documentElement,r=i.getElementsByTagName("body")[0];return(e.innerHeight||s.clientHeight||r.clientHeight)*t/100},tileClicked:function(t){if("Spoiler"===this.gameStatus){var e=this.game.toggleStar(t);this.numOfStars+=e,this.refreshBoard()}else if("Choreographer"===this.gameStatus){var i=this.game.toggleDancer(t);this.step=this.game.getNumStep(),this.refreshBoard(),i&&this.choreoFinish()}},getGameParams:function(){return 0===this.gameLevel?{size:5,groups:2,dancers:2}:1===this.gameLevel?{size:10,groups:2,dancers:4}:2===this.gameLevel?{size:10,groups:4,dancers:4}:{size:15,groups:5,dancers:5}},startPose:function(){this.gameStatus="Spoiler",this.game.generateDancers(),this.refreshBoard(),this.mainBtnText="FINISH",this.startTimer()},donePose:function(){this.gameStatus="SpoilerFinish",this.game.donePose(),this.refreshBoard(),this.mainBtnText="Dance!"},startChoreographer:function(){this.disableMainBtn=!1,this.mainBtnText="Finish Step",this.gameStatus="Choreographer",this.game.startSolve(),this.refreshBoard(),this.startTimer()},choreoFinish:function(){this.stopTimer(),this.gameStatus="Finish",this.disableMainBtn=!1,this.mainBtnText="A new game!"},resetGame:function(){this.gameStatus="Initialized",this.mainBtnText="GO!",this.disableMainBtn=!1,this.step=0,this.numOfStars=0,this.resetTimer();var t=this.getGameParams();this.game=new Z(t.size,t.groups,t.dancers),this.refreshBoard()},resetTimer:function(){this.stopTimer(),this.time=120,this.timer=null,this.timerOn=!1,this.startTime=null},startTimer:function(){var t=this;this.timerOn=!0,this.startTime=Date.now(),this.timer=setInterval(function(){t.time=120-(Date.now()-t.startTime)/1e3,t.time<=0&&t.handleTimeOut()},10)},stopTimer:function(){this.timer&&(clearInterval(this.timer),this.timerOn=!1)},handleTimeOut:function(){"Spoiler"===this.gameStatus?(this.choreoFinish(),this.$message.error("Spoiler timeout."),this.step="Spoiler timeout"):"Choreographer"===this.gameStatus&&(this.choreoFinish(),this.$message.error("Choreographer timeout."),this.step="Choreographer timeout")}}},Q=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"Game"},[s("div",[s("el-container",[s("el-main",[s("img",{staticStyle:{width:"85%",height:"65%"},attrs:{src:i("j73W")}})]),t._v(" "),s("el-main",[s("div",{staticClass:"block"},[s("el-row",[s("el-col",{style:{fontWeight:"bold",color:"#006400"}},[t._v("easy - 5 x 5, 2 color groups, 2 dancers each group")]),t._v(" "),s("el-col",{style:{fontWeight:"bold",color:"#FFD700"}},[t._v("intermediate - 10 x 10, 2 color groups, 4 dancers each group")]),t._v(" "),s("el-col",{style:{fontWeight:"bold",color:"#FFA500"}},[t._v("hard - 10 x 10, 4 color groups, 4 dancers each group")]),t._v(" "),s("el-col",{style:{fontWeight:"bold",color:"#A52A2A"}},[t._v("hell - 15 x 15, 5 color groups, 5 dancers each group")])],1)],1),t._v(" "),s("el-form",[s("el-form-item",[s("el-row",{staticClass:"row-bg",attrs:{type:"flex",justify:"center"}},[s("el-col",{attrs:{span:6}},[s("el-slider",{attrs:{max:3,"format-tooltip":t.levelFormatTooltip,"show-stops":""},model:{value:t.gameLevel,callback:function(e){t.gameLevel=e},expression:"gameLevel"}})],1)],1)],1),t._v(" "),s("el-form-item",[s("el-row",{staticClass:"row-bg",attrs:{type:"flex",justify:"center"}},[s("el-col",{attrs:{span:6}},[s("el-button",{staticStyle:{width:"20vw","background-color":"#2F4F4F"},attrs:{size:"large",type:"primary"},on:{click:t.openGamePanel}},[t._v("ENTER")])],1)],1)],1)],1)],1),t._v(" "),s("el-footer",[s("el-button",{attrs:{type:"text"},on:{click:function(e){t.aboutDialogVisible=!0}}},[s("h3",{staticStyle:{color:"#2c3e50"}},[t._v("About")])]),t._v(" "),s("h3",{staticStyle:{color:"#00FFFF"}},[t._v("Use a mouse for better experience.")])],1)],1)],1),t._v(" "),s("div",[s("el-dialog",{attrs:{title:"About",visible:t.aboutDialogVisible,width:"40%",height:"70%"},on:{"update:visible":function(e){t.aboutDialogVisible=e}}},[s("div",[t._v("\n        Dancing without the stars 2017.\n      ")]),t._v(" "),s("div",[t._v("License: MIT")])])],1),t._v(" "),s("el-dialog",{attrs:{title:t.gameStatus,visible:t.gamePanelVisible,fullscreen:!0,"before-close":t.handleCancel},on:{"update:visible":function(e){t.gamePanelVisible=e}}},[s("el-container",[s("el-header",[s("el-row",{staticStyle:{"font-weight":"bold"},attrs:{gutter:20}},[s("el-col",{attrs:{span:6}},[s("span",{staticStyle:{color:"#A52A2A"}},[t._v("timer: "+t._s(t.time>0?t.time.toFixed(2):"0.00"))])]),t._v(" "),s("el-col",{attrs:{span:6}},[s("span",{staticStyle:{color:"#D2691E"}},[t._v("stars: "+t._s(t.numOfStars)+"/"+t._s(t.maxNumOfStars))])]),t._v(" "),s("el-col",{attrs:{span:6}},[s("span",{staticStyle:{color:"#556B2F"}},[t._v("step: "+t._s(t.step))])]),t._v(" "),s("el-col",{attrs:{span:6}},[s("el-button",{attrs:{type:"success",size:"large",disabled:t.disableMainBtn,round:""},on:{click:function(e){t.handleMainBtn()}}},[t._v(t._s(t.mainBtnText)+"\n            ")])],1)],1)],1),t._v(" "),s("el-main",[s("Board",{attrs:{boardLength:t.vhTOpx(70),tiles:t.tiles,tileTypes:t.tileTypes,tileClicked:t.tileClicked}})],1)],1)],1)],1)},X=[],tt={render:Q,staticRenderFns:X},et=tt,it=i("VU/8"),st=it(K,et,!1,null,null,null),rt=st.exports;n.default.use(T.a);var at=new T.a({routes:[{path:"/",name:"Game",component:rt}]});n.default.use(h.a),n.default.config.productionTip=!1,new n.default({el:"#app",router:at,template:"<App/>",components:{App:g}})},j73W:function(t,e,i){t.exports=i.p+"static/img/1200px-Dancing_without_the_Stars_Title_Logo.svg.b6d8c45.png"},tvR6:function(t,e){},xfsC:function(t,e){}},["NHnr"]);
//# sourceMappingURL=app.424f908d068bc4f01637.js.map